---
title: "yasuhirokiã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãƒ©ã‚¤ãƒ•ã‚’æ”¯ãˆã‚‹æŠ€è¡“"
emoji: "ğŸ¦Š"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [terminal, cli, shell, vim]
published: true
---

(ä¸å®šæœŸã«æ›´æ–°ã—ã¾ã™)

# ã¯ã˜ã‚ã«

ç§ã“ã¨ @yasuhiroki ãŒæ—¥ã€…ã®é–‹ç™ºã§ä½¿ã£ã¦ã„ã‚‹ãƒ„ãƒ¼ãƒ«ã‚„æŠ€è¡“ã«ã¤ã„ã¦ç´¹ä»‹ã™ã‚‹è¨˜äº‹ã§ã™ã€‚

# Terminal

## [WezTerm](https://wezfurlong.org/wezterm/index.html)

iTerm2 + tmux ã®ç”Ÿæ´»ã«é£½ããŸã®ã§ä¹—ã‚Šæ›ãˆã¦åˆ©ç”¨ã—ã¦ã„ã‚‹ã€‚
tmux ã£ã½ã„ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã‚’è¨­å®šã—ã¦ã„ã‚‹ãŒã€ `copy_mode` ã¨ `search_mode` ã®åˆ‡ã‚Šæ›¿ãˆãŒã¾ã æ‰‹ã«é¦´æŸ“ã‚“ã§ãªãã¦è©¦è¡ŒéŒ¯èª¤ä¸­ã€‚

ã¾ãŸ iTerm2 ã® `password manager` ã«ç›¸å½“ã™ã‚‹æ©Ÿèƒ½ãŒã¾ã ãªãã¦ã¡ã‚‡ã£ã¨ä¸ä¾¿ã€‚
`security` ã‚³ãƒãƒ³ãƒ‰ã‹ã‚‰å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ãã†ãªã®ã§æ¤œè¨¼äºˆå®šã€‚[^1]

[^1]: https://github.com/wez/wezterm/issues/1579

é–‹ç™ºä½œæ¥­ã§æ‰±ã£ã¦ã„ã‚‹ãƒªãƒã‚¸ãƒˆãƒªã”ã¨ã« Window ã‚’ä½œã£ã¦ä½œæ¥­ã™ã‚‹ã®ãŒå¥½ã¿ã€‚

# Shell

## Zsh

macOS ä½¿ã£ã¦ã„ã‚‹ã®ã§ zsh ã‚’ä½¿ã£ã¦ã„ã‚‹ã€‚
zsh å›ºæœ‰ã®æ©Ÿèƒ½ã‚’ä½¿ã„ã“ãªã—ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„ã€‚

### [zimfw](https://github.com/zimfw/zimfw)

ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç®¡ç†ã«ã¯ zimfw ã‚’ä½¿ã£ã¦ã„ã‚‹ã€‚zplug ã‹ã‚‰ä¹—ã‚Šæ›ãˆãŸã€‚
ä¸»ã« `zsh-users` ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ã„ãã¤ã‹ã¨ã€ã‚ªãƒ¬ã‚ªãƒ¬ä¾¿åˆ©ã‚³ãƒãƒ³ãƒ‰ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«ä½¿ç”¨ã—ã¦ã„ã‚‹ã€‚

## [enhancd](https://github.com/babarot/enhancd)

`cd` ã‚³ãƒãƒ³ãƒ‰ã‚’å¼·åŒ–ã—ã¦ãã‚Œã‚‹ãƒ„ãƒ¼ãƒ«ã€‚ä¾¿åˆ©ã€‚

# Editor

## [MacVim](https://macvim.org)

æ°—ã¥ã‘ã° Vim ã‚’ä½¿ã„åˆã‚ã¦ã‹ã‚‰ 10å¹´ä»¥ä¸ŠçµŒã£ã¦ã„ã‚‹ã€‚
Vim ã® `:terminal` ã§æš®ã‚‰ã™ã“ã¨ã‚’æ¯å¹´è€ƒãˆã‚‹ã‘ã©ã€å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆãŒç…©ã‚ã—ãã¦ä½¿ã£ã¦ã„ãªã„ã€‚[^2]

[^2]: ãªã®ã§ zsh ã‚‚ emacs ãƒ¢ãƒ¼ãƒ‰ã§åˆ©ç”¨ã—ã¦ã„ã‚‹

# Proguraming Language

## [asdf](https://github.com/asdf-vm/asdf)

å„è¨€èªã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãƒ„ãƒ¼ãƒ«ã€‚
ä»Šã®ç§ã®æ¥­å‹™ã§ã¯ãã‚“ãªã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã—ãªãã¦ã„ã„ã®ã§ã€å„è¨€èªã®ä¾¿åˆ©ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ„ãƒ¼ãƒ«ã¨ã„ã†ç¨‹åº¦ã®ä½¿ã„æ–¹ã‚’ã—ã¦ã„ã‚‹ã€‚

[mise](https://github.com/jdx/mise) ã«ä¹—ã‚Šæ›ãˆã‚‹ã‹ã¯ã€ `asdf` ã¨ã„ã†ã®ãŒã‚¿ã‚¤ãƒ—ã—ã‚„ã™ã„ã¨ã“ã‚ãŒæ°—ã«å…¥ã‚Šã™ãã¦ã„ã¦æ¤œè¨ã‚’å¾Œå›ã—ã«ã—ã¦ã„ã‚‹ã€‚[^2]

[^2]: `alias asdf=mise` ã™ã‚Œã°è‰¯ã„ã¨ã„ã†èª¬ã‚‚ã‚ã‚‹ã‘ã©ã€ãªã‚“ã¨ãªãè‰¯ã„æ°—åˆ†ãŒã—ãªã„

## [ruby](https://docs.ruby-lang.org/ja/latest/doc/spec=2frubycmd.html#ruby)

`sed` ã‚„ `awk` ã‚ˆã‚Šã‚‚ã€ ruby ã® String ã‚¯ãƒ©ã‚¹ã‚„ Enumerator ã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ãŸã»ã†ãŒæ¥½ã«å‡¦ç†ã§ããã†ã€ã¨æ€ã£ãŸæ™‚ã«ä½¿ã†ã€‚

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ `-nale` ã‹ `-pale` ã‚’ä½¿ã†ã“ã¨ãŒå¤šã„ã€‚

```bash
# -nale ã¯ å…¥åŠ› ($_) ã‚’å…ƒã«åˆ¥ã®å‡ºåŠ›ã‚’ä½œã‚ŠãŸã„æ™‚ã«ä½¿ã†
$ seq 4 | ruby -nale 'puts "=" * $_.to_i'
=
==
===
====

# -a ã«ã‚ˆã£ã¦ $F ãŒä½¿ãˆã‚‹ã®ã§ã¶ã‚“å›ã—ãŸã„æ™‚ã«ä¾¿åˆ©ãªã®ã§ã¨ã‚Šã‚ãˆãšã¤ã‘ã¨ã
$ seq 4 | xargs | ruby -nale 'puts $F.map(&:to_i).sum'
10

# -pale ã¯ puts ã‚„ p ã‚’æ›¸ãã®ãŒé¢å€’ãã•ã„æ™‚ã«ä½¿ã†
$ seq 4 | ruby -pale '$_ += " lines"'
1 lines
2 lines
3 lines
4 lines
```

# Git

`git alias` ã§æ¬¡ã®ã‚ˆã†ãªã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚’ä½œã£ã¦ã„ã‚‹ã€‚

```bash
# ã‚³ãƒãƒ³ãƒ‰ã®çŸ­ç¸®
alias.ri=rebase -i
alias.fp=fetch -p
alias.fixup=commit --fixup

# Branch ã®æ•´ç†ã€æ¤œç´¢
alias.poi=!git branch -D $(git branch --merged | grep -v '^*')
alias.oide=!f() { local branches branch; branches=$(git branch --sort=-authordate --all | grep -v HEAD | sort -t/ -k1,1 -s) && branch=$(echo "$branches" | fzf-tmux -d $(( 2 + $(wc -l <<< "$branches") )) +m) && git checkout $(echo "$branch" | sed "s/.* //" | sed "s#remotes/[^/]*/##"); }; f

# æ­£è¦è¡¨ç¾ã§ commit history ã‹ã‚‰æ¤œç´¢
alias.look=log -p -G

# commit ãƒªã‚¹ãƒˆã‚’å–å¾— (ãƒ—ãƒ«ãƒªã‚¯ã®èª¬æ˜æ–‡ã‚’æ›¸ãã¨ãã®å‚è€ƒã«ã™ã‚‹)
alias.done=!f() { git log --pretty=format:'- [x] %s' ${1:-origin/develop}..${2:-HEAD} | awk '$0' | tac ; }; f

# ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆã™ã‚‹
alias.prpr=!prpr() { local t="$(mktemp).md"; echo "PullRequest title" > "$t"; vim "$t"; local f="$(mktemp).md"; cp "$(git rev-parse --show-toplevel)/.github/PULL_REQUEST_TEMPLATE.md" "$f" || true; vim "$f"; gh pr create -w -a @me -t "$(head -n1 "${t}")" -F "${f}" ${@} ; }; prpr

# ghq get ã£ã½ã„ã‚¤ãƒ¡ãƒ¼ã‚¸ã®å‹•ä½œã‚’ gh ã‚³ãƒãƒ³ãƒ‰ã§ã™ã‚‹
alias.get=!get() { local repo="yasuhiroki/${1:?required OWNER/REPO}"; shift 1; local dist="${repo%/*}"; dist="github.com/${dist##*/}/${repo##*/}"; gh repo clone ${repo#yasuhiroki/} ~/src/${dist} -- ${@} ; }; get
```

## [gina.vim](https://github.com/lambdalisue/gina.vim) ã¨ [agit.vim](https://github.com/cohama/agit.vim)

Git ã®æ“ä½œã¯ vim ä¸Šã§è¡Œã†ã“ã¨ãŒå¤šã„ã€‚

`:Gina status` ã§ add ã—ã¦ `:Gina commit` ã—ã¦ `:Agit` ã§ commit ãƒ„ãƒªãƒ¼ã‚’ç¢ºèªã™ã‚‹æµã‚Œã‚’æ¯æ—¥ã®ã‚ˆã†ã«è¡Œã£ã¦ã„ã‚‹ã€‚

gina.vim ã¯ãã®ã†ã¡ [gin.vim](https://github.com/lambdalisue/gin.vim) ã«ç§»è¡Œã—ãªã„ã¨ãªãã€‚

## [gh](https://cli.github.com)

GitHub ã®ã‚ã‚Œã“ã‚Œã‚’ã™ã‚‹ã®ã« `gh` ã‚’ä½¿ã†ã€‚
å‰è¿°ã® `git` ã® alias ã§ã‚‚ `gh` ã‚’ä½¿ã£ã¦ã„ã‚‹ã€‚

`gh api` ãŒä½¿ãˆã‚Œã°ã ã„ãŸã„ä½•ã§ã‚‚ã§ãã‚‹ã€‚

# CLI

## JSON

### [jq](https://jqlang.github.io/jq/)

curl ã‚„ AWS CLI ã§ JSON ã‚’æ‰±ã†æ™‚ã¯ã¨ã‚Šã‚ãˆãš `jq` ã‚’ä½¿ã†ã€‚
100ååˆ†ã®ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã®ãŸã‚ã«APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ã¨ã‹ã€ ã‚ˆãä½¿ã† AWS ã®æ“ä½œã‚’ã¾ã¨ã‚ã¦å®Ÿè¡Œã™ã‚‹ã¨ã‹ã€æ›¸ãæ¨ã¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã›ã‚ˆCI/CDç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã›ã‚ˆã€ JSON ã¯ä¸€æ—¦ `jq` ã§å—ã‘å–ã£ã¦ãŠãã¨æ¥½ã€‚

#### è¦šãˆã¦ãŠãã¨ä¾¿åˆ©ãªæ©Ÿèƒ½

```bash
# ä»–ã®ã‚³ãƒãƒ³ãƒ‰ã§æ‰±ã„ã‚„ã™ã„ã‚ˆã† csv ã«å¤‰æ›ã™ã‚‹
$ gh api '/users/yasuhiroki' | jq -r '[.login,.html_url]|@csv'
"yasuhiroki","https://github.com/yasuhiroki"

# 2ã¤ã®JSONã‚’ãƒãƒ¼ã‚¸ã—ã¦1ã¤ã®JSONã«ã™ã‚‹
$ jq -s '.[0] * .[1]' <(echo '{"a": 1}') <(echo '{"b": 2}')
{
  "a": 1,
  "b": 2
}
```

### [jo](https://github.com/jpmens/jo)

JSON ã‚’ä½œã‚‹æ™‚ã«ä¾¿åˆ©ãªãƒ„ãƒ¼ãƒ«ã€‚
ç‰¹ã«ä»–ã®ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›ã‚’ã‚‚ã¨ã«JSONã‚’ä½œã‚ŠãŸã„æ™‚ã«ä¾¿åˆ©ã€‚å¹´ã«2å›ãã‚‰ã„ã€ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’è¦šãˆã¦ãŠã„ã¦ç‰¹ã‚’ã—ãŸã‚ˆã†ãªæ°—ãŒã™ã‚‹ã€‚ãŸã¶ã‚“ã€‚

### [gron](https://github.com/tomnomnom/gron)

JSON ã‚’ grep ã—ã‚„ã™ã„æ–‡å­—åˆ—ã«å¤‰æ›ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã€‚
`... | jq '.ã™ã”ã„è¤‡é›‘ãªå‡¦ç†'` ã¨ã‹ `... | jq . | sed 's/ã™ã”ã„è¤‡é›‘ãªå‡¦ç†/'` ãªã©ã¨æ›¸ããã†ã«ãªã£ãŸã‚‰ `gron` ã‚’ä½¿ã†ã¨ã‚·ãƒ³ãƒ—ãƒ«ã«ãªã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚

ãŸã¨ãˆã° JSON ã‹ã‚‰ `xxx_url` ãª key ã¨ value ã®ã¿å–ã‚Šé™¤ã“ã†ã¨ã™ã‚‹ã¨ã€

```bash
# jq ã§ã‚„ã‚Šåˆ‡ã‚ã†ã¨ã™ã‚‹ã¨
$ cat sample.json | jq 'walk(if type == "object" then with_entries(select(.key | contains("_url") | not)) else . end)'

# gron ã‚’ä½¿ã†ã¨
$ cat a.json| gron | grep -v '_url =' | gron -u
```

ã¨ã„ã†æ„Ÿã˜ã«ãªã‚‹ã€‚

ãŸã ã€gron ã¯ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã•ã‚Œãªããªã£ã¦ä¹…ã—ã„ã®ã§ã€ä»£æ›¿ãƒ„ãƒ¼ãƒ«ã‚’æ¢ã—ã¦ã‚‚ã„ã„ã‹ãªãã¨ã„ã†æ°—åˆ†ã§ã¯ã‚ã‚‹ã€‚

## æ•°å€¤è¨ˆç®—

### [datamash](https://www.gnu.org/software/datamash/)

ç°¡å˜ãªè¨ˆç®—ã‚„çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’å¾—ã‚‹æ™‚ã¯ datamash ã‚’ä½¿ã£ã¦ã„ã‚‹ã€‚

```sh
# å¹³å‡å€¤ã‚’æ±‚ã‚ã‚‹
$ seq 10 | datamash mean 1
5.5

# issue ã® reaction æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹
$ gh api '/repos/rails/rails/issues' | jq -r '.[].reactions | [."+1", ."-1"] | @tsv' | datamash sum 1 sum 2
10      0

# issue ã«ã¤ã‘ã‚‰ã‚ŒãŸ label ã”ã¨ã® reactionsæ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹
$ gh api '/repos/rails/rails/issues' | jq -r '.[] | {l: [.labels[].name], r: [(.reactions | ."+1", ."-1")]} | ((.l[] | [.]) + .r) | @tsv' | sort | datamash groupby 1 sum 2
With reproduction steps 0
actioncable     0
actionmailbox   0
actionmailer    0
actionpack      4
actiontext      0
actionview      3
activejob       0
activemodel     0
activerecord    0
activestorage   0
activesupport   0
attached PR     1
docs    1
railties        0
```

ã‚ã‚“ã¾ã‚Šè¤‡é›‘ã«ãªã£ã¦ãã‚‹ã¨ Ruby ã§æ›¸ã„ãŸã‚Šã€ãƒãƒ¼ãƒ å†…ã§èª°ã§ã‚‚è¨ˆç®—çµæœã‚’å¾—ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã—ãŸã‹ã£ãŸã‚‰ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã§ä½œã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚

# HTTP API é–‹ç™º

## [curl](https://curl.se)

HTTP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ CLI ã¯ [httpie](https://httpie.io) ã¨ã‹ [xh](https://github.com/ducaale/xh) ãªã©ä½¿ã„ã‚„ã™ã„ã‚‚ã®ãŒã£ã¦ä½•åº¦ã‹è§¦ã£ã¦ã¿ãŸã‘ã©ã€HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…å®¹ã‚’è‡ªåˆ†ã§ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã—ãŸã„ã“ã¨ãŒåº¦ã€…ã‚ã£ã¦ `curl` ã«æˆ»ã£ã¦ãã¦ã„ã‚‹ã€‚

`curl` ã¯æ˜”ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ãã‚Œãªã‚Šã«èª­ã‚“ã ã“ã¨ãŒã‚ã£ã¦æ„›ç€ãŒã‚ã‚‹ã®ã‚‚å¤§ãã„ã€‚

## [goaccess](https://goaccess.io)

ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°åˆ†æãƒ„ãƒ¼ãƒ«ã€‚
API ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ‰‹ã£å–ã‚Šæ—©ãèª¿ã¹ã‚‹æ™‚ã«ä½¿ã£ã¦ã„ã‚‹ã€‚

ä»Šã©ãã¯ã€DataDog ãªã© SaaS ã‚’åˆ©ç”¨ã—ã¦å¯è¦–åŒ–ã™ã‚‹ã‚‚ã®ãªã®ã‹ã‚‚ã—ã‚Œãªã„ã€‚

## [ab](https://httpd.apache.org/docs/current/programs/ab.html)

ab ã“ã¨ Apache HTTP server benchmarking toolã€‚
CLIã§ãŠæ‰‹è»½ã«è² è·ãƒ†ã‚¹ãƒˆã§ãã‚‹ã€‚

ab ã‚³ãƒãƒ³ãƒ‰ã§è² è·ã‚’ã‹ã‘ã¦ goaccess ã§çµæœã‚’ç¢ºèªã™ã‚‹ã€ã¨ã„ã†æµã‚Œã§ä½œæ¥­ã™ã‚‹ã“ã¨ãŒå¤šã„ã€‚

